{"ast":null,"code":"import _asyncToGenerator from \"/home/angeloacr/Proyectos/loteriaNacional/app/loteriaNacionalFront/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CarritoService {\n  //mySource = this.productionSource;\n  constructor(http) {\n    this.http = http;\n    this.total = 0;\n    this.totalConDesc = 0;\n    this.ticketsLoteria = {};\n    this.ticketsLotto = {};\n    this.ticketsPozo = {};\n    this.ticketsMillonaria = {};\n    this.ticketsCarrito = [];\n    this.reservaId = 0;\n    this.localSource = 'http://localhost:100';\n    this.testSource = 'https://ventas-api-prueba.loteria.com.ec';\n    this.productionSource = 'https://ventas-api.loteria.com.ec'; //mySource = this.localSource;\n\n    this.mySource = this.testSource;\n  }\n\n  eliminarDescuento(element, tipoLoteria) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let sorteo = element.sorteo;\n\n      switch (tipoLoteria) {\n        case 1:\n          let loteria = _this.getLoteriaLocal();\n\n          for (let id in loteria) {\n            if (loteria[id].sorteo.sorteo == sorteo) {\n              loteria[id].tieneDescuento = false;\n              loteria[id].subtotalConDesc = 0;\n            }\n          }\n\n          _this.setLoteriaLocal(loteria);\n\n          break;\n\n        case 2:\n          let lotto = _this.getLottoLocal();\n\n          for (let id in lotto) {\n            if (lotto[id].sorteo.sorteo == sorteo) {\n              lotto[id].tieneDescuento = false;\n              lotto[id].subtotalConDesc = 0;\n            }\n          }\n\n          _this.setLottoLocal(lotto);\n\n          break;\n\n        case 5:\n          let pozo = _this.getPozoLocal();\n\n          for (let id in pozo) {\n            if (pozo[id].sorteo.sorteo == sorteo) {\n              pozo[id].tieneDescuento = false;\n              pozo[id].subtotalConDesc = 0;\n            }\n          }\n\n          _this.setPozoLocal(pozo);\n\n          break;\n\n        case 14:\n          let millonaria = _this.getMillonariaLocal();\n\n          for (let id in millonaria) {\n            if (millonaria[id].sorteo.sorteo == sorteo) {\n              millonaria[id].tieneDescuento = false;\n              millonaria[id].subtotalConDesc = 0;\n            }\n          }\n\n          _this.setMillonariaLocal(millonaria);\n\n          break;\n      }\n\n      yield _this.actualizarCarrito();\n    })();\n  }\n\n  calcularDescuento(descuento) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      return;\n      let precioConDescuento = descuento.valorConDescuento;\n      let sorteo = descuento.sorteo;\n\n      switch (descuento.tipoLoteria) {\n        case '1':\n          let loteria = _this2.getLoteriaLocal();\n\n          for (let id in loteria) {\n            if (loteria[id].sorteo.sorteo == sorteo) {\n              loteria[id].tieneDescuento = true;\n              loteria[id].subtotalConDesc = loteria[id].ticket.seleccionados.length * parseFloat(precioConDescuento);\n            }\n          }\n\n          _this2.setLoteriaLocal(loteria);\n\n          break;\n\n        case '2':\n          let lotto = _this2.getLottoLocal();\n\n          for (let id in lotto) {\n            if (lotto[id].sorteo.sorteo == sorteo) {\n              lotto[id].tieneDescuento = true;\n              lotto[id].subtotalConDesc = parseFloat(precioConDescuento);\n            }\n          }\n\n          _this2.setLottoLocal(lotto);\n\n          break;\n\n        case '5':\n          let pozo = _this2.getPozoLocal();\n\n          for (let id in pozo) {\n            if (pozo[id].sorteo.sorteo == sorteo) {\n              pozo[id].tieneDescuento = true;\n              pozo[id].subtotalConDesc = parseFloat(precioConDescuento);\n            }\n          }\n\n          _this2.setPozoLocal(pozo);\n\n          break;\n\n        case '14':\n          let millonaria = _this2.getMillonariaLocal();\n\n          for (let id in millonaria) {\n            if (millonaria[id].sorteo.sorteo == sorteo) {\n              millonaria[id].tieneDescuento = true;\n              millonaria[id].subtotalConDesc = parseFloat(precioConDescuento);\n            }\n          }\n\n          _this2.setMillonariaLocal(millonaria);\n\n          break;\n      }\n\n      yield _this2.actualizarCarrito();\n    })();\n  }\n\n  contarBoletos(sorteo, tipoLoteria) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      let aux = _this3.getCarritoLocal();\n\n      let boletos = aux.filter(item => item.sorteo.sorteo == sorteo && item.tipoLoteria == tipoLoteria);\n      let conteo;\n\n      switch (tipoLoteria) {\n        case 1:\n          conteo = boletos.reduce((total, value) => {\n            return total + value.ticket.seleccionados.length;\n          }, 0);\n          break;\n\n        case 14:\n          conteo = boletos.reduce((total, value) => {\n            return total + value.ticket.seleccionados.length;\n          }, 0);\n          break;\n\n        default:\n          conteo = boletos.length;\n          break;\n      }\n\n      return conteo;\n    })();\n  }\n\n  removeFromCart(ticket, tipoLoteria) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      let carrito = yield _this4.getCarrito();\n      let deletedIndex = carrito.findIndex(x => x.identificador === ticket.identificador && x.tipoLoteria == tipoLoteria);\n      carrito.splice(deletedIndex, 1);\n      _this4.ticketsCarrito = carrito;\n      localStorage.setItem('seleccionadosCarrito', JSON.stringify(carrito));\n    })();\n  }\n\n  getReservaId() {\n    let reservaId = JSON.parse(localStorage.getItem('reservaId'));\n\n    if (reservaId && reservaId != '') {\n      return reservaId;\n    } else {\n      return 0;\n    }\n  }\n\n  setReservaId(id) {\n    localStorage.setItem('reservaId', JSON.stringify(id));\n  }\n\n  getCount() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      let carrito = yield _this5.getCarrito();\n      let count = 0;\n\n      if (carrito && carrito.length) {\n        carrito.forEach(item => {\n          if (item.tipoLoteria == 1) {\n            count += item.ticket.seleccionados.length;\n          } else {\n            count += 1;\n          }\n        });\n      }\n\n      return count;\n    })();\n  }\n\n  setCarrito(ticket, tipoLoteria) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      let carrito = _this6.getCarritoLocal();\n\n      if (!carrito) carrito = [];\n      ticket['identificador'] = ticket.ticket.identificador;\n      ticket['tipoLoteria'] = tipoLoteria;\n      let addIndex = carrito.findIndex(x => x.identificador === ticket.identificador);\n\n      if ((tipoLoteria == 1 || tipoLoteria == 14) && addIndex != -1) {\n        carrito[addIndex] = ticket;\n      } else {\n        carrito.push(ticket);\n      }\n\n      _this6.ticketsCarrito = carrito;\n      localStorage.setItem('seleccionadosCarrito', JSON.stringify(carrito));\n    })();\n  }\n\n  actualizarCarrito() {\n    var _this7 = this;\n\n    return new Promise( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (resolve, reject) {\n        let headers = new HttpHeaders();\n        headers = headers.append('Content-Type', 'application/json');\n        let address = '/reservas';\n        let endpoint = '/cache';\n        let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n        let body = {\n          loteria: _this7.getLoteriaLocal(),\n          lotto: _this7.getLottoLocal(),\n          pozo: _this7.getPozoLocal(),\n          millonaria: _this7.getMillonariaLocal(),\n          carrito: _this7.getCarritoLocal(),\n          total: _this7.getTotal(),\n          reservaId: _this7.getReservaId(),\n          user\n        };\n        endpoint = `${endpoint}/actualizarCarrito`;\n        address = _this7.mySource + address + endpoint;\n\n        _this7.http.post(address, body, {\n          headers: headers\n        }).subscribe(data => {\n          resolve('Done');\n        }, error => {\n          reject(new Error(error.error.message));\n        });\n      });\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  setCarritoLoteria(tickets) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (resolve, reject) {\n          localStorage.setItem('seleccionadosLoteria', JSON.stringify(tickets)); //this.ticketsLoteria = tickets;\n\n          yield _this8.setTotal();\n          yield _this8.actualizarCarrito();\n          resolve('Done');\n        });\n\n        return function (_x3, _x4) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  setCarritoMillonaria(tickets) {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(function* (resolve, reject) {\n          localStorage.setItem('seleccionadosMillonaria', JSON.stringify(tickets)); //this.ticketsLoteria = tickets;\n\n          yield _this9.setTotal();\n          yield _this9.actualizarCarrito();\n          resolve('Done');\n        });\n\n        return function (_x5, _x6) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  setCarritoLotto(tickets) {\n    var _this10 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref4 = _asyncToGenerator(function* (resolve, reject) {\n          localStorage.setItem('seleccionadosLotto', JSON.stringify(tickets)); //this.ticketsLotto = tickets;\n\n          yield _this10.setTotal();\n          yield _this10.actualizarCarrito();\n          resolve('Done');\n        });\n\n        return function (_x7, _x8) {\n          return _ref4.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  setCarritoPozo(tickets) {\n    var _this11 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref5 = _asyncToGenerator(function* (resolve, reject) {\n          localStorage.setItem('seleccionadosPozo', JSON.stringify(tickets)); //this.ticketsPozo = tickets;\n\n          yield _this11.setTotal();\n          yield _this11.actualizarCarrito();\n          resolve('Done');\n        });\n\n        return function (_x9, _x10) {\n          return _ref5.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  setCarritoLocal(data) {\n    localStorage.setItem('seleccionadosCarrito', JSON.stringify(data));\n  }\n\n  setLoteriaLocal(data) {\n    localStorage.setItem('seleccionadosLoteria', JSON.stringify(data));\n  }\n\n  setMillonariaLocal(data) {\n    localStorage.setItem('seleccionadosMillonaria', JSON.stringify(data));\n  }\n\n  setLottoLocal(data) {\n    localStorage.setItem('seleccionadosLotto', JSON.stringify(data));\n  }\n\n  setPozoLocal(data) {\n    localStorage.setItem('seleccionadosPozo', JSON.stringify(data));\n  }\n\n  getCarritoLocal() {\n    let carrito = JSON.parse(localStorage.getItem('seleccionadosCarrito'));\n\n    if (carrito && carrito.length) {\n      return carrito;\n    } else {\n      return [];\n    }\n  }\n\n  getLoteriaLocal() {\n    return JSON.parse(localStorage.getItem('seleccionadosLoteria'));\n  }\n\n  getMillonariaLocal() {\n    return JSON.parse(localStorage.getItem('seleccionadosMillonaria'));\n  }\n\n  getLottoLocal() {\n    return JSON.parse(localStorage.getItem('seleccionadosLotto'));\n  }\n\n  getPozoLocal() {\n    return JSON.parse(localStorage.getItem('seleccionadosPozo'));\n  }\n\n  buscarCarrito() {\n    var _this12 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref6 = _asyncToGenerator(function* (resolve, reject) {\n          let headers = new HttpHeaders();\n          headers = headers.append('Content-Type', 'application/json');\n          let address = '/reservas';\n          let endpoint = '/cache';\n          let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n          let body = {\n            user\n          };\n          endpoint = `${endpoint}/getCarrito`;\n          address = _this12.mySource + address + endpoint;\n\n          _this12.http.post(address, body, {\n            headers: headers\n          }).subscribe( /*#__PURE__*/function () {\n            var _ref7 = _asyncToGenerator(function* (data) {\n              let reservaId = _this12.getReservaId();\n\n              if (data.carrito.length == 0) {\n                _this12.borrarCarrito();\n\n                data.carrito = [];\n                data.loteria = {};\n                data.lotto = {};\n                data.pozo = {};\n                data.millonaria = {};\n                data.reservaId = 0;\n              }\n\n              _this12.setCarritoLocal(data.carrito);\n\n              _this12.setLoteriaLocal(data.loteria);\n\n              _this12.setLottoLocal(data.lotto);\n\n              _this12.setMillonariaLocal(data.millonaria);\n\n              _this12.setPozoLocal(data.pozo);\n\n              _this12.setReservaId(data.reservaId);\n\n              yield _this12.setTotal();\n              resolve(data);\n            });\n\n            return function (_x13) {\n              return _ref7.apply(this, arguments);\n            };\n          }(), error => {\n            reject(new Error(error.error.message));\n          });\n        });\n\n        return function (_x11, _x12) {\n          return _ref6.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  validarCarrito(reservaId) {\n    var _this13 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref8 = _asyncToGenerator(function* (resolve, reject) {\n          let headers = new HttpHeaders();\n          headers = headers.append('Content-Type', 'application/json');\n          let address = '/reservas';\n          let endpoint = '/cache';\n          let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n          let token = JSON.parse(localStorage.getItem('userData')).lotteryToken;\n          let body = {\n            user,\n            token,\n            reservaId\n          };\n          endpoint = `${endpoint}/validar`;\n          address = _this13.mySource + address + endpoint;\n\n          _this13.http.post(address, body, {\n            headers: headers\n          }).subscribe(data => {\n            /*           if (!data.status) {\n              reject(new Error(data.message));\n            }\n            */\n            resolve(data);\n          }, error => {\n            reject(new Error(error.error.message));\n          });\n        });\n\n        return function (_x14, _x15) {\n          return _ref8.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getCarrito() {\n    var _this14 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref9 = _asyncToGenerator(function* (resolve, reject) {\n          let carritoDB = yield _this14.buscarCarrito();\n          resolve(carritoDB.carrito); //resolve(JSON.parse(localStorage.getItem(\"seleccionadosCarrito\")));\n        });\n\n        return function (_x16, _x17) {\n          return _ref9.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getCarritoLoteria() {\n    var _this15 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref10 = _asyncToGenerator(function* (resolve, reject) {\n          let carritoDB = yield _this15.buscarCarrito();\n          resolve(carritoDB.loteria); //resolve(JSON.parse(localStorage.getItem(\"seleccionadosLoteria\")));\n        });\n\n        return function (_x18, _x19) {\n          return _ref10.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getCarritoLotto() {\n    var _this16 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref11 = _asyncToGenerator(function* (resolve, reject) {\n          let carritoDB = yield _this16.buscarCarrito();\n          resolve(carritoDB.lotto); //resolve(JSON.parse(localStorage.getItem(\"seleccionadosLotto\")));\n        });\n\n        return function (_x20, _x21) {\n          return _ref11.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getCarritoPozo() {\n    var _this17 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref12 = _asyncToGenerator(function* (resolve, reject) {\n          let carritoDB = yield _this17.buscarCarrito();\n          resolve(carritoDB.pozo); //resolve(JSON.parse(localStorage.getItem(\"seleccionadosPozo\")));\n        });\n\n        return function (_x22, _x23) {\n          return _ref12.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getCarritoMillonaria() {\n    var _this18 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref13 = _asyncToGenerator(function* (resolve, reject) {\n          let carritoDB = yield _this18.buscarCarrito();\n          resolve(carritoDB.millonaria); //resolve(JSON.parse(localStorage.getItem(\"seleccionadosPozo\")));\n        });\n\n        return function (_x24, _x25) {\n          return _ref13.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  borrarCarrito() {\n    var _this19 = this;\n\n    return _asyncToGenerator(function* () {\n      _this19.ticketsCarrito = [];\n      _this19.ticketsLoteria = {};\n      _this19.ticketsLotto = {};\n      _this19.ticketsPozo = {};\n      _this19.ticketsMillonaria = {};\n      _this19.reservaId = 0;\n      _this19.total = 0;\n      localStorage.removeItem('seleccionadosLoteria');\n      localStorage.removeItem('seleccionadosLotto');\n      localStorage.removeItem('seleccionadosPozo');\n      localStorage.removeItem('seleccionadosCarrito');\n      localStorage.removeItem('seleccionadosMillonaria');\n      localStorage.removeItem('reservaId');\n      localStorage.removeItem('total');\n      localStorage.removeItem('totalConDesc');\n      return new Promise( /*#__PURE__*/function () {\n        var _ref14 = _asyncToGenerator(function* (resolve, reject) {\n          let headers = new HttpHeaders();\n          headers = headers.append('Content-Type', 'application/json');\n          let address = '/reservas';\n          let endpoint = '/cache';\n          let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n          let body = {\n            user\n          };\n          endpoint = `${endpoint}/borrarCarrito`;\n          address = _this19.mySource + address + endpoint;\n\n          _this19.http.post(address, body, {\n            headers: headers\n          }).subscribe(data => {\n            resolve('Done');\n          }, error => {\n            reject(new Error(error.error.message));\n          });\n        });\n\n        return function (_x26, _x27) {\n          return _ref14.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  setTotalConDesc() {\n    var _this20 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref15 = _asyncToGenerator(function* (resolve, reject) {\n          //await this.buscarCarrito();\n          let loteriaAux = _this20.getLoteriaLocal();\n\n          let lottoAux = _this20.getLottoLocal();\n\n          let pozoAux = _this20.getPozoLocal();\n\n          let millonariaAux = _this20.getMillonariaLocal();\n\n          let loteriaConDesc = 0;\n\n          for (let id in loteriaAux) {\n            if (loteriaAux[id].tieneDescuento) {\n              loteriaConDesc += parseFloat(loteriaAux[id].subtotalConDesc);\n            } else {\n              loteriaConDesc += parseFloat(loteriaAux[id].subtotal);\n            }\n          }\n\n          let lottoConDesc = 0;\n\n          for (let id in lottoAux) {\n            if (lottoAux[id].tieneDescuento) {\n              lottoConDesc += parseFloat(lottoAux[id].subtotalConDesc);\n            } else {\n              lottoConDesc += parseFloat(lottoAux[id].subtotal);\n            }\n          }\n\n          let pozoConDesc = 0;\n\n          for (let id in pozoAux) {\n            if (pozoAux[id].tieneDescuento) {\n              pozoConDesc += parseFloat(pozoAux[id].subtotalConDesc);\n            } else {\n              pozoConDesc += parseFloat(pozoAux[id].subtotal);\n            }\n          }\n\n          let millonariaConDesc = 0;\n\n          for (let id in millonariaAux) {\n            if (millonariaAux[id].tieneDescuento) {\n              millonariaConDesc += parseFloat(millonariaAux[id].subtotalConDesc);\n            } else {\n              millonariaConDesc += parseFloat(millonariaAux[id].subtotal);\n            }\n          }\n\n          let auxConDesc = loteriaConDesc + lottoConDesc + pozoConDesc + millonariaConDesc;\n          _this20.totalConDesc = auxConDesc;\n          localStorage.setItem('totalConDesc', JSON.stringify(auxConDesc));\n          resolve('Done');\n        });\n\n        return function (_x28, _x29) {\n          return _ref15.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  setTotal() {\n    var _this21 = this;\n\n    return _asyncToGenerator(function* () {\n      return new Promise( /*#__PURE__*/function () {\n        var _ref16 = _asyncToGenerator(function* (resolve, reject) {\n          //await this.buscarCarrito();\n          let loteriaAux = _this21.getLoteriaLocal();\n\n          let lottoAux = _this21.getLottoLocal();\n\n          let pozoAux = _this21.getPozoLocal();\n\n          let millonariaAux = _this21.getMillonariaLocal();\n\n          let loteria = 0;\n\n          for (let id in loteriaAux) {\n            loteria += parseFloat(loteriaAux[id].subtotal);\n          }\n\n          let lotto = 0;\n\n          for (let id in lottoAux) {\n            lotto += parseFloat(lottoAux[id].subtotal);\n          }\n\n          let pozo = 0;\n\n          for (let id in pozoAux) {\n            pozo += parseFloat(pozoAux[id].subtotal);\n          }\n\n          let millonaria = 0;\n\n          for (let id in millonariaAux) {\n            millonaria += parseFloat(millonariaAux[id].subtotal);\n          }\n\n          let aux = loteria + lotto + pozo + millonaria;\n          _this21.total = aux;\n          localStorage.setItem('total', JSON.stringify(aux));\n          resolve('Done');\n        });\n\n        return function (_x30, _x31) {\n          return _ref16.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getTotal() {\n    //return this.total;\n    let total = JSON.parse(localStorage.getItem('total'));\n\n    if (total) {\n      return total;\n    } else {\n      return 0;\n    }\n  }\n\n  getTotalConDesc() {\n    //return this.total;\n    let total = JSON.parse(localStorage.getItem('totalConDesc'));\n\n    if (total) {\n      return total;\n    } else {\n      return 0;\n    }\n  }\n\n}\n\nCarritoService.ɵfac = function CarritoService_Factory(t) {\n  return new (t || CarritoService)(i0.ɵɵinject(i1.HttpClient));\n};\n\nCarritoService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CarritoService,\n  factory: CarritoService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/home/angeloacr/Proyectos/loteriaNacional/app/loteriaNacionalFront/src/app/ventas/services/carrito.service.ts"],"names":["HttpHeaders","i0","i1","CarritoService","constructor","http","total","totalConDesc","ticketsLoteria","ticketsLotto","ticketsPozo","ticketsMillonaria","ticketsCarrito","reservaId","localSource","testSource","productionSource","mySource","eliminarDescuento","element","tipoLoteria","sorteo","loteria","getLoteriaLocal","id","tieneDescuento","subtotalConDesc","setLoteriaLocal","lotto","getLottoLocal","setLottoLocal","pozo","getPozoLocal","setPozoLocal","millonaria","getMillonariaLocal","setMillonariaLocal","actualizarCarrito","calcularDescuento","descuento","precioConDescuento","valorConDescuento","ticket","seleccionados","length","parseFloat","contarBoletos","aux","getCarritoLocal","boletos","filter","item","conteo","reduce","value","removeFromCart","carrito","getCarrito","deletedIndex","findIndex","x","identificador","splice","localStorage","setItem","JSON","stringify","getReservaId","parse","getItem","setReservaId","getCount","count","forEach","setCarrito","addIndex","push","Promise","resolve","reject","headers","append","address","endpoint","user","playerDocument","body","getTotal","post","subscribe","data","error","Error","message","setCarritoLoteria","tickets","setTotal","setCarritoMillonaria","setCarritoLotto","setCarritoPozo","setCarritoLocal","buscarCarrito","borrarCarrito","validarCarrito","token","lotteryToken","carritoDB","getCarritoLoteria","getCarritoLotto","getCarritoPozo","getCarritoMillonaria","removeItem","setTotalConDesc","loteriaAux","lottoAux","pozoAux","millonariaAux","loteriaConDesc","subtotal","lottoConDesc","pozoConDesc","millonariaConDesc","auxConDesc","getTotalConDesc","ɵfac","CarritoService_Factory","t","ɵɵinject","HttpClient","ɵprov","ɵɵdefineInjectable","factory","providedIn"],"mappings":"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","sourcesContent":["import { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CarritoService {\n    //mySource = this.productionSource;\n    constructor(http) {\n        this.http = http;\n        this.total = 0;\n        this.totalConDesc = 0;\n        this.ticketsLoteria = {};\n        this.ticketsLotto = {};\n        this.ticketsPozo = {};\n        this.ticketsMillonaria = {};\n        this.ticketsCarrito = [];\n        this.reservaId = 0;\n        this.localSource = 'http://localhost:100';\n        this.testSource = 'https://ventas-api-prueba.loteria.com.ec';\n        this.productionSource = 'https://ventas-api.loteria.com.ec';\n        //mySource = this.localSource;\n        this.mySource = this.testSource;\n    }\n    async eliminarDescuento(element, tipoLoteria) {\n        let sorteo = element.sorteo;\n        switch (tipoLoteria) {\n            case 1:\n                let loteria = this.getLoteriaLocal();\n                for (let id in loteria) {\n                    if (loteria[id].sorteo.sorteo == sorteo) {\n                        loteria[id].tieneDescuento = false;\n                        loteria[id].subtotalConDesc = 0;\n                    }\n                }\n                this.setLoteriaLocal(loteria);\n                break;\n            case 2:\n                let lotto = this.getLottoLocal();\n                for (let id in lotto) {\n                    if (lotto[id].sorteo.sorteo == sorteo) {\n                        lotto[id].tieneDescuento = false;\n                        lotto[id].subtotalConDesc = 0;\n                    }\n                }\n                this.setLottoLocal(lotto);\n                break;\n            case 5:\n                let pozo = this.getPozoLocal();\n                for (let id in pozo) {\n                    if (pozo[id].sorteo.sorteo == sorteo) {\n                        pozo[id].tieneDescuento = false;\n                        pozo[id].subtotalConDesc = 0;\n                    }\n                }\n                this.setPozoLocal(pozo);\n                break;\n            case 14:\n                let millonaria = this.getMillonariaLocal();\n                for (let id in millonaria) {\n                    if (millonaria[id].sorteo.sorteo == sorteo) {\n                        millonaria[id].tieneDescuento = false;\n                        millonaria[id].subtotalConDesc = 0;\n                    }\n                }\n                this.setMillonariaLocal(millonaria);\n                break;\n        }\n        await this.actualizarCarrito();\n    }\n    async calcularDescuento(descuento) {\n        return;\n        let precioConDescuento = descuento.valorConDescuento;\n        let sorteo = descuento.sorteo;\n        switch (descuento.tipoLoteria) {\n            case '1':\n                let loteria = this.getLoteriaLocal();\n                for (let id in loteria) {\n                    if (loteria[id].sorteo.sorteo == sorteo) {\n                        loteria[id].tieneDescuento = true;\n                        loteria[id].subtotalConDesc =\n                            loteria[id].ticket.seleccionados.length *\n                                parseFloat(precioConDescuento);\n                    }\n                }\n                this.setLoteriaLocal(loteria);\n                break;\n            case '2':\n                let lotto = this.getLottoLocal();\n                for (let id in lotto) {\n                    if (lotto[id].sorteo.sorteo == sorteo) {\n                        lotto[id].tieneDescuento = true;\n                        lotto[id].subtotalConDesc = parseFloat(precioConDescuento);\n                    }\n                }\n                this.setLottoLocal(lotto);\n                break;\n            case '5':\n                let pozo = this.getPozoLocal();\n                for (let id in pozo) {\n                    if (pozo[id].sorteo.sorteo == sorteo) {\n                        pozo[id].tieneDescuento = true;\n                        pozo[id].subtotalConDesc = parseFloat(precioConDescuento);\n                    }\n                }\n                this.setPozoLocal(pozo);\n                break;\n            case '14':\n                let millonaria = this.getMillonariaLocal();\n                for (let id in millonaria) {\n                    if (millonaria[id].sorteo.sorteo == sorteo) {\n                        millonaria[id].tieneDescuento = true;\n                        millonaria[id].subtotalConDesc = parseFloat(precioConDescuento);\n                    }\n                }\n                this.setMillonariaLocal(millonaria);\n                break;\n        }\n        await this.actualizarCarrito();\n    }\n    async contarBoletos(sorteo, tipoLoteria) {\n        let aux = this.getCarritoLocal();\n        let boletos = aux.filter((item) => item.sorteo.sorteo == sorteo && item.tipoLoteria == tipoLoteria);\n        let conteo;\n        switch (tipoLoteria) {\n            case 1:\n                conteo = boletos.reduce((total, value) => {\n                    return total + value.ticket.seleccionados.length;\n                }, 0);\n                break;\n            case 14:\n                conteo = boletos.reduce((total, value) => {\n                    return total + value.ticket.seleccionados.length;\n                }, 0);\n                break;\n            default:\n                conteo = boletos.length;\n                break;\n        }\n        return conteo;\n    }\n    async removeFromCart(ticket, tipoLoteria) {\n        let carrito = await this.getCarrito();\n        let deletedIndex = carrito.findIndex((x) => x.identificador === ticket.identificador && x.tipoLoteria == tipoLoteria);\n        carrito.splice(deletedIndex, 1);\n        this.ticketsCarrito = carrito;\n        localStorage.setItem('seleccionadosCarrito', JSON.stringify(carrito));\n    }\n    getReservaId() {\n        let reservaId = JSON.parse(localStorage.getItem('reservaId'));\n        if (reservaId && reservaId != '') {\n            return reservaId;\n        }\n        else {\n            return 0;\n        }\n    }\n    setReservaId(id) {\n        localStorage.setItem('reservaId', JSON.stringify(id));\n    }\n    async getCount() {\n        let carrito = await this.getCarrito();\n        let count = 0;\n        if (carrito && carrito.length) {\n            carrito.forEach((item) => {\n                if (item.tipoLoteria == 1) {\n                    count += item.ticket.seleccionados.length;\n                }\n                else {\n                    count += 1;\n                }\n            });\n        }\n        return count;\n    }\n    async setCarrito(ticket, tipoLoteria) {\n        let carrito = this.getCarritoLocal();\n        if (!carrito)\n            carrito = [];\n        ticket['identificador'] = ticket.ticket.identificador;\n        ticket['tipoLoteria'] = tipoLoteria;\n        let addIndex = carrito.findIndex((x) => x.identificador === ticket.identificador);\n        if ((tipoLoteria == 1 || tipoLoteria == 14) && addIndex != -1) {\n            carrito[addIndex] = ticket;\n        }\n        else {\n            carrito.push(ticket);\n        }\n        this.ticketsCarrito = carrito;\n        localStorage.setItem('seleccionadosCarrito', JSON.stringify(carrito));\n    }\n    actualizarCarrito() {\n        return new Promise(async (resolve, reject) => {\n            let headers = new HttpHeaders();\n            headers = headers.append('Content-Type', 'application/json');\n            let address = '/reservas';\n            let endpoint = '/cache';\n            let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n            let body = {\n                loteria: this.getLoteriaLocal(),\n                lotto: this.getLottoLocal(),\n                pozo: this.getPozoLocal(),\n                millonaria: this.getMillonariaLocal(),\n                carrito: this.getCarritoLocal(),\n                total: this.getTotal(),\n                reservaId: this.getReservaId(),\n                user,\n            };\n            endpoint = `${endpoint}/actualizarCarrito`;\n            address = this.mySource + address + endpoint;\n            this.http.post(address, body, { headers: headers }).subscribe((data) => {\n                resolve('Done');\n            }, (error) => {\n                reject(new Error(error.error.message));\n            });\n        });\n    }\n    async setCarritoLoteria(tickets) {\n        return new Promise(async (resolve, reject) => {\n            localStorage.setItem('seleccionadosLoteria', JSON.stringify(tickets));\n            //this.ticketsLoteria = tickets;\n            await this.setTotal();\n            await this.actualizarCarrito();\n            resolve('Done');\n        });\n    }\n    async setCarritoMillonaria(tickets) {\n        return new Promise(async (resolve, reject) => {\n            localStorage.setItem('seleccionadosMillonaria', JSON.stringify(tickets));\n            //this.ticketsLoteria = tickets;\n            await this.setTotal();\n            await this.actualizarCarrito();\n            resolve('Done');\n        });\n    }\n    async setCarritoLotto(tickets) {\n        return new Promise(async (resolve, reject) => {\n            localStorage.setItem('seleccionadosLotto', JSON.stringify(tickets));\n            //this.ticketsLotto = tickets;\n            await this.setTotal();\n            await this.actualizarCarrito();\n            resolve('Done');\n        });\n    }\n    async setCarritoPozo(tickets) {\n        return new Promise(async (resolve, reject) => {\n            localStorage.setItem('seleccionadosPozo', JSON.stringify(tickets));\n            //this.ticketsPozo = tickets;\n            await this.setTotal();\n            await this.actualizarCarrito();\n            resolve('Done');\n        });\n    }\n    setCarritoLocal(data) {\n        localStorage.setItem('seleccionadosCarrito', JSON.stringify(data));\n    }\n    setLoteriaLocal(data) {\n        localStorage.setItem('seleccionadosLoteria', JSON.stringify(data));\n    }\n    setMillonariaLocal(data) {\n        localStorage.setItem('seleccionadosMillonaria', JSON.stringify(data));\n    }\n    setLottoLocal(data) {\n        localStorage.setItem('seleccionadosLotto', JSON.stringify(data));\n    }\n    setPozoLocal(data) {\n        localStorage.setItem('seleccionadosPozo', JSON.stringify(data));\n    }\n    getCarritoLocal() {\n        let carrito = JSON.parse(localStorage.getItem('seleccionadosCarrito'));\n        if (carrito && carrito.length) {\n            return carrito;\n        }\n        else {\n            return [];\n        }\n    }\n    getLoteriaLocal() {\n        return JSON.parse(localStorage.getItem('seleccionadosLoteria'));\n    }\n    getMillonariaLocal() {\n        return JSON.parse(localStorage.getItem('seleccionadosMillonaria'));\n    }\n    getLottoLocal() {\n        return JSON.parse(localStorage.getItem('seleccionadosLotto'));\n    }\n    getPozoLocal() {\n        return JSON.parse(localStorage.getItem('seleccionadosPozo'));\n    }\n    async buscarCarrito() {\n        return new Promise(async (resolve, reject) => {\n            let headers = new HttpHeaders();\n            headers = headers.append('Content-Type', 'application/json');\n            let address = '/reservas';\n            let endpoint = '/cache';\n            let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n            let body = {\n                user,\n            };\n            endpoint = `${endpoint}/getCarrito`;\n            address = this.mySource + address + endpoint;\n            this.http.post(address, body, { headers: headers }).subscribe(async (data) => {\n                let reservaId = this.getReservaId();\n                if (data.carrito.length == 0) {\n                    this.borrarCarrito();\n                    data.carrito = [];\n                    data.loteria = {};\n                    data.lotto = {};\n                    data.pozo = {};\n                    data.millonaria = {};\n                    data.reservaId = 0;\n                }\n                this.setCarritoLocal(data.carrito);\n                this.setLoteriaLocal(data.loteria);\n                this.setLottoLocal(data.lotto);\n                this.setMillonariaLocal(data.millonaria);\n                this.setPozoLocal(data.pozo);\n                this.setReservaId(data.reservaId);\n                await this.setTotal();\n                resolve(data);\n            }, (error) => {\n                reject(new Error(error.error.message));\n            });\n        });\n    }\n    async validarCarrito(reservaId) {\n        return new Promise(async (resolve, reject) => {\n            let headers = new HttpHeaders();\n            headers = headers.append('Content-Type', 'application/json');\n            let address = '/reservas';\n            let endpoint = '/cache';\n            let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n            let token = JSON.parse(localStorage.getItem('userData')).lotteryToken;\n            let body = {\n                user,\n                token,\n                reservaId,\n            };\n            endpoint = `${endpoint}/validar`;\n            address = this.mySource + address + endpoint;\n            this.http.post(address, body, { headers: headers }).subscribe((data) => {\n                /*           if (!data.status) {\n                  reject(new Error(data.message));\n                }\n       */ resolve(data);\n            }, (error) => {\n                reject(new Error(error.error.message));\n            });\n        });\n    }\n    async getCarrito() {\n        return new Promise(async (resolve, reject) => {\n            let carritoDB = await this.buscarCarrito();\n            resolve(carritoDB.carrito);\n            //resolve(JSON.parse(localStorage.getItem(\"seleccionadosCarrito\")));\n        });\n    }\n    async getCarritoLoteria() {\n        return new Promise(async (resolve, reject) => {\n            let carritoDB = await this.buscarCarrito();\n            resolve(carritoDB.loteria);\n            //resolve(JSON.parse(localStorage.getItem(\"seleccionadosLoteria\")));\n        });\n    }\n    async getCarritoLotto() {\n        return new Promise(async (resolve, reject) => {\n            let carritoDB = await this.buscarCarrito();\n            resolve(carritoDB.lotto);\n            //resolve(JSON.parse(localStorage.getItem(\"seleccionadosLotto\")));\n        });\n    }\n    async getCarritoPozo() {\n        return new Promise(async (resolve, reject) => {\n            let carritoDB = await this.buscarCarrito();\n            resolve(carritoDB.pozo);\n            //resolve(JSON.parse(localStorage.getItem(\"seleccionadosPozo\")));\n        });\n    }\n    async getCarritoMillonaria() {\n        return new Promise(async (resolve, reject) => {\n            let carritoDB = await this.buscarCarrito();\n            resolve(carritoDB.millonaria);\n            //resolve(JSON.parse(localStorage.getItem(\"seleccionadosPozo\")));\n        });\n    }\n    async borrarCarrito() {\n        this.ticketsCarrito = [];\n        this.ticketsLoteria = {};\n        this.ticketsLotto = {};\n        this.ticketsPozo = {};\n        this.ticketsMillonaria = {};\n        this.reservaId = 0;\n        this.total = 0;\n        localStorage.removeItem('seleccionadosLoteria');\n        localStorage.removeItem('seleccionadosLotto');\n        localStorage.removeItem('seleccionadosPozo');\n        localStorage.removeItem('seleccionadosCarrito');\n        localStorage.removeItem('seleccionadosMillonaria');\n        localStorage.removeItem('reservaId');\n        localStorage.removeItem('total');\n        localStorage.removeItem('totalConDesc');\n        return new Promise(async (resolve, reject) => {\n            let headers = new HttpHeaders();\n            headers = headers.append('Content-Type', 'application/json');\n            let address = '/reservas';\n            let endpoint = '/cache';\n            let user = JSON.parse(localStorage.getItem('userData')).playerDocument;\n            let body = {\n                user,\n            };\n            endpoint = `${endpoint}/borrarCarrito`;\n            address = this.mySource + address + endpoint;\n            this.http.post(address, body, { headers: headers }).subscribe((data) => {\n                resolve('Done');\n            }, (error) => {\n                reject(new Error(error.error.message));\n            });\n        });\n    }\n    async setTotalConDesc() {\n        return new Promise(async (resolve, reject) => {\n            //await this.buscarCarrito();\n            let loteriaAux = this.getLoteriaLocal();\n            let lottoAux = this.getLottoLocal();\n            let pozoAux = this.getPozoLocal();\n            let millonariaAux = this.getMillonariaLocal();\n            let loteriaConDesc = 0;\n            for (let id in loteriaAux) {\n                if (loteriaAux[id].tieneDescuento) {\n                    loteriaConDesc += parseFloat(loteriaAux[id].subtotalConDesc);\n                }\n                else {\n                    loteriaConDesc += parseFloat(loteriaAux[id].subtotal);\n                }\n            }\n            let lottoConDesc = 0;\n            for (let id in lottoAux) {\n                if (lottoAux[id].tieneDescuento) {\n                    lottoConDesc += parseFloat(lottoAux[id].subtotalConDesc);\n                }\n                else {\n                    lottoConDesc += parseFloat(lottoAux[id].subtotal);\n                }\n            }\n            let pozoConDesc = 0;\n            for (let id in pozoAux) {\n                if (pozoAux[id].tieneDescuento) {\n                    pozoConDesc += parseFloat(pozoAux[id].subtotalConDesc);\n                }\n                else {\n                    pozoConDesc += parseFloat(pozoAux[id].subtotal);\n                }\n            }\n            let millonariaConDesc = 0;\n            for (let id in millonariaAux) {\n                if (millonariaAux[id].tieneDescuento) {\n                    millonariaConDesc += parseFloat(millonariaAux[id].subtotalConDesc);\n                }\n                else {\n                    millonariaConDesc += parseFloat(millonariaAux[id].subtotal);\n                }\n            }\n            let auxConDesc = loteriaConDesc + lottoConDesc + pozoConDesc + millonariaConDesc;\n            this.totalConDesc = auxConDesc;\n            localStorage.setItem('totalConDesc', JSON.stringify(auxConDesc));\n            resolve('Done');\n        });\n    }\n    async setTotal() {\n        return new Promise(async (resolve, reject) => {\n            //await this.buscarCarrito();\n            let loteriaAux = this.getLoteriaLocal();\n            let lottoAux = this.getLottoLocal();\n            let pozoAux = this.getPozoLocal();\n            let millonariaAux = this.getMillonariaLocal();\n            let loteria = 0;\n            for (let id in loteriaAux) {\n                loteria += parseFloat(loteriaAux[id].subtotal);\n            }\n            let lotto = 0;\n            for (let id in lottoAux) {\n                lotto += parseFloat(lottoAux[id].subtotal);\n            }\n            let pozo = 0;\n            for (let id in pozoAux) {\n                pozo += parseFloat(pozoAux[id].subtotal);\n            }\n            let millonaria = 0;\n            for (let id in millonariaAux) {\n                millonaria += parseFloat(millonariaAux[id].subtotal);\n            }\n            let aux = loteria + lotto + pozo + millonaria;\n            this.total = aux;\n            localStorage.setItem('total', JSON.stringify(aux));\n            resolve('Done');\n        });\n    }\n    getTotal() {\n        //return this.total;\n        let total = JSON.parse(localStorage.getItem('total'));\n        if (total) {\n            return total;\n        }\n        else {\n            return 0;\n        }\n    }\n    getTotalConDesc() {\n        //return this.total;\n        let total = JSON.parse(localStorage.getItem('totalConDesc'));\n        if (total) {\n            return total;\n        }\n        else {\n            return 0;\n        }\n    }\n}\nCarritoService.ɵfac = function CarritoService_Factory(t) { return new (t || CarritoService)(i0.ɵɵinject(i1.HttpClient)); };\nCarritoService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CarritoService, factory: CarritoService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}
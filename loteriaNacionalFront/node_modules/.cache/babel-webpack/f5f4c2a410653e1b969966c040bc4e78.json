{"ast":null,"code":"import _asyncToGenerator from \"/home/angeloacr/Proyectos/loteriaNacional/app/loteriaNacionalFront/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ConsultaService {\n  constructor(http) {\n    this.http = http;\n    this.today = new Date();\n    this.localSource = 'http://localhost:100';\n    this.testSource = 'https://ventas-api-prueba.loteria.com.ec';\n    this.productionSource = 'https://ventas-api.loteria.com.ec'; //mySource = this.localSource;\n    //mySource = this.testSource;\n\n    this.mySource = this.productionSource;\n  }\n\n  recuperarSorteosJugados() {\n    let headers = new HttpHeaders();\n    headers = headers.append('Content-Type', 'application/json');\n    var address = '/loteria';\n    let endpoint = '/cache';\n    endpoint = `${endpoint}/sorteosJugados`;\n    address = this.mySource + address + endpoint;\n    return new Promise((resolve, reject) => {\n      this.http.get(address, {\n        headers: headers\n      }).subscribe(data => {\n        let sorteosJugados = data.values;\n        console.log(sorteosJugados);\n        sorteosJugados.sort(this.ordenaSorteos);\n        resolve(sorteosJugados);\n      });\n    });\n  }\n\n  ordenaSorteos(a, b) {\n    let a1 = a['sorteo'];\n    let b1 = b['sorteo'];\n    return b1 - a1;\n  }\n\n  recuperarBoletoGanador(sorteo, combinaciones) {\n    let headers = new HttpHeaders();\n    headers = headers.append('Content-Type', 'application/json');\n    let endpoint = '';\n    let address = '/loteria';\n    endpoint = `${endpoint}/ganador`;\n    address = this.mySource + address + endpoint;\n    let body = {\n      sorteo,\n      combinaciones\n    };\n    console.log(body);\n    return new Promise((resolve, reject) => {\n      this.http.post(address, body, {\n        headers: headers\n      }).subscribe(data => {\n        let boletoGanador = data;\n        resolve(boletoGanador);\n      }, error => {\n        reject(new Error(error.error.message));\n      });\n    });\n  }\n\n  getUltimoResultado() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let headers = new HttpHeaders();\n      headers = headers.append('Content-Type', 'application/json');\n      let address = '/loteria';\n      let endpoint = '/cache/ultimoResultado';\n      let auxAddress = _this.mySource + address + endpoint;\n      return new Promise((resolve, reject) => {\n        _this.http.get(auxAddress, {\n          headers: headers\n        }).subscribe(data => {\n          let response;\n          let loteriaNacional = data;\n          localStorage.setItem('loteriaNacionalUltimoResultado', JSON.stringify(loteriaNacional));\n          response = {\n            tipo: 'loteriaNacional',\n            data: loteriaNacional\n          };\n          resolve(response);\n        }, error => {\n          reject(new Error(error.error.message));\n        });\n      });\n    })();\n  }\n\n  obtenerBoletin(sorteo) {\n    let sourceBoletines = `${this.mySource}/uploads/boletines/`;\n    return new Promise((resolve, reject) => {\n      let boletinAddress = `${sourceBoletines}T1${sorteo}.jpg`;\n      resolve(boletinAddress);\n    });\n  }\n\n}\n\nConsultaService.ɵfac = function ConsultaService_Factory(t) {\n  return new (t || ConsultaService)(i0.ɵɵinject(i1.HttpClient));\n};\n\nConsultaService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ConsultaService,\n  factory: ConsultaService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/home/angeloacr/Proyectos/loteriaNacional/app/loteriaNacionalFront/src/app/juegos/loteria/services/consulta.service.ts"],"names":["HttpHeaders","i0","i1","ConsultaService","constructor","http","today","Date","localSource","testSource","productionSource","mySource","recuperarSorteosJugados","headers","append","address","endpoint","Promise","resolve","reject","get","subscribe","data","sorteosJugados","values","console","log","sort","ordenaSorteos","a","b","a1","b1","recuperarBoletoGanador","sorteo","combinaciones","body","post","boletoGanador","error","Error","message","getUltimoResultado","auxAddress","response","loteriaNacional","localStorage","setItem","JSON","stringify","tipo","obtenerBoletin","sourceBoletines","boletinAddress","ɵfac","ConsultaService_Factory","t","ɵɵinject","HttpClient","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ConsultaService {\n    constructor(http) {\n        this.http = http;\n        this.today = new Date();\n        this.localSource = 'http://localhost:100';\n        this.testSource = 'https://ventas-api-prueba.loteria.com.ec';\n        this.productionSource = 'https://ventas-api.loteria.com.ec';\n        //mySource = this.localSource;\n        //mySource = this.testSource;\n        this.mySource = this.productionSource;\n    }\n    recuperarSorteosJugados() {\n        let headers = new HttpHeaders();\n        headers = headers.append('Content-Type', 'application/json');\n        var address = '/loteria';\n        let endpoint = '/cache';\n        endpoint = `${endpoint}/sorteosJugados`;\n        address = this.mySource + address + endpoint;\n        return new Promise((resolve, reject) => {\n            this.http.get(address, { headers: headers }).subscribe((data) => {\n                let sorteosJugados = data.values;\n                console.log(sorteosJugados);\n                sorteosJugados.sort(this.ordenaSorteos);\n                resolve(sorteosJugados);\n            });\n        });\n    }\n    ordenaSorteos(a, b) {\n        let a1 = a['sorteo'];\n        let b1 = b['sorteo'];\n        return b1 - a1;\n    }\n    recuperarBoletoGanador(sorteo, combinaciones) {\n        let headers = new HttpHeaders();\n        headers = headers.append('Content-Type', 'application/json');\n        let endpoint = '';\n        let address = '/loteria';\n        endpoint = `${endpoint}/ganador`;\n        address = this.mySource + address + endpoint;\n        let body = {\n            sorteo,\n            combinaciones,\n        };\n        console.log(body);\n        return new Promise((resolve, reject) => {\n            this.http.post(address, body, { headers: headers }).subscribe((data) => {\n                let boletoGanador = data;\n                resolve(boletoGanador);\n            }, (error) => {\n                reject(new Error(error.error.message));\n            });\n        });\n    }\n    async getUltimoResultado() {\n        let headers = new HttpHeaders();\n        headers = headers.append('Content-Type', 'application/json');\n        let address = '/loteria';\n        let endpoint = '/cache/ultimoResultado';\n        let auxAddress = this.mySource + address + endpoint;\n        return new Promise((resolve, reject) => {\n            this.http.get(auxAddress, { headers: headers }).subscribe((data) => {\n                let response;\n                let loteriaNacional = data;\n                localStorage.setItem('loteriaNacionalUltimoResultado', JSON.stringify(loteriaNacional));\n                response = { tipo: 'loteriaNacional', data: loteriaNacional };\n                resolve(response);\n            }, (error) => {\n                reject(new Error(error.error.message));\n            });\n        });\n    }\n    obtenerBoletin(sorteo) {\n        let sourceBoletines = `${this.mySource}/uploads/boletines/`;\n        return new Promise((resolve, reject) => {\n            let boletinAddress = `${sourceBoletines}T1${sorteo}.jpg`;\n            resolve(boletinAddress);\n        });\n    }\n}\nConsultaService.ɵfac = function ConsultaService_Factory(t) { return new (t || ConsultaService)(i0.ɵɵinject(i1.HttpClient)); };\nConsultaService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ConsultaService, factory: ConsultaService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}
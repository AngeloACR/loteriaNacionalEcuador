{"ast":null,"code":"import _asyncToGenerator from \"/home/angeloacr/Proyectos/loteriaNacional/app/loteriaNacionalFront/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/consulta.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../../../shared/components/loader/loader.component\";\nimport * as i6 from \"../../../../shared/components/error/error.component\";\n\nfunction ConsultaComponent_option_47_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r4.sorteo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" N\\u00B0 \", option_r4.sorteo, \" - \", option_r4.fecha, \" \");\n  }\n}\n\nfunction ConsultaComponent_option_63_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r5.sorteo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" N\\u00B0 \", option_r5.sorteo, \" - \", option_r5.fecha, \" \");\n  }\n}\n\nfunction ConsultaComponent_app_loader_66_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-loader\", 23);\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"message\", ctx_r2.loadingMessage);\n  }\n}\n\nfunction ConsultaComponent_app_error_67_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-error\", 24);\n    i0.ɵɵlistener(\"closeError\", function ConsultaComponent_app_error_67_Template_app_error_closeError_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.closeError();\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"msg\", ctx_r3.errorMessage);\n  }\n}\n\nexport let ConsultaComponent = /*#__PURE__*/(() => {\n  class ConsultaComponent {\n    constructor(router, consulta, changeDetectorRef) {\n      this.router = router;\n      this.consulta = consulta;\n      this.changeDetectorRef = changeDetectorRef;\n      this.combinacion = '';\n      this.serie = '';\n      this.maxDigits = 4;\n      this.numbers = [];\n      this.previousLength = 0;\n      this.cameFromBackspace = false;\n      this.resultados = new EventEmitter();\n      this.isLoading = false;\n      this.loadingMessage = 'Consultando los resultados';\n      this.isError = false;\n      this.errorMessage = '';\n    }\n\n    ngOnInit() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        console.log('En la consulta de la millonaria');\n        _this.sorteosJugados = yield _this.consulta.recuperarSorteosJugados();\n\n        _this.setSorteoDefault();\n      })();\n    }\n\n    setSorteoDefault() {\n      this.changeDetectorRef.detectChanges();\n      this.sorteoGanador = 'default';\n      this.sorteoBoletin = 'default';\n      this.changeDetectorRef.markForCheck();\n    }\n\n    validateCombinacion() {\n      this.changeDetectorRef.detectChanges();\n      let reg = /[^0-9]/g;\n      this.combinacion = this.combinacion.replace(reg, '');\n      this.changeDetectorRef.markForCheck();\n    }\n\n    validateSerie() {\n      this.changeDetectorRef.detectChanges();\n      let reg = /[^0-9]/g;\n      this.serie = this.serie.replace(reg, '');\n      this.changeDetectorRef.markForCheck();\n    }\n\n    validate() {\n      let reg = /[^0-9]/g;\n      let currentLength = this.combinacion.length;\n      let addComma = false;\n\n      if (this.previousLength > currentLength) {\n        if (this.combinacion[currentLength - 1] == ',') {\n          this.combinacion = this.combinacion.slice(0, -1);\n          this.cameFromBackspace = true;\n        }\n      } else {\n        this.numbers = this.combinacion.split(', ');\n\n        if (this.cameFromBackspace) {\n          let lastNumber = this.numbers[this.numbers.length - 1];\n          let auxLength = lastNumber.length;\n          let number = lastNumber[auxLength - 1];\n          this.numbers[this.numbers.length - 1] = lastNumber.slice(0, -1);\n          this.numbers.push(number);\n          this.cameFromBackspace = false;\n        }\n\n        this.combinacion = '';\n        let numbersLength = this.numbers.length;\n        let lastNumberAux = this.numbers[numbersLength - 1];\n        lastNumberAux = lastNumberAux.replace(reg, '');\n\n        if (lastNumberAux.length == this.maxDigits + 1) {\n          let lastNumber = lastNumberAux[this.maxDigits];\n          let beforeLastNumber = lastNumberAux.slice(0, -1);\n          this.numbers.pop();\n          this.numbers.push(beforeLastNumber);\n          this.numbers.push(lastNumber);\n        }\n\n        numbersLength = this.numbers.length;\n        this.numbers.forEach((number, index) => {\n          number = number.replace(reg, '');\n          this.combinacion = `${this.combinacion}${number}`;\n\n          if (number.length == this.maxDigits && index != numbersLength - 1) {\n            this.combinacion = `${this.combinacion}, `;\n          }\n        });\n      }\n\n      this.previousLength = this.combinacion.length;\n    }\n\n    triggerLoader() {\n      this.isLoading = true;\n    }\n\n    dismissLoader() {\n      this.isLoading = false;\n    }\n\n    preventArrow(e) {\n      if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].indexOf(e.code) > -1) {\n        e.preventDefault();\n      }\n    }\n\n    moveCursorToEnd(e) {\n      this.changeDetectorRef.detectChanges();\n      let el = e.target;\n\n      if (typeof el.selectionStart == 'number') {\n        el.selectionStart = el.selectionEnd = el.value.length;\n      } else if (typeof el.createTextRange != 'undefined') {\n        el.focus();\n        var range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n      }\n\n      this.changeDetectorRef.markForCheck();\n    }\n\n    buscarBoletoGanador() {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        try {\n          _this2.triggerLoader();\n\n          if (!_this2.combinacion.length) throw new Error('Por favor, escribe la combinación que quieras consultar');\n          /*       let aux = this.combinacion;\n          if (this.combinacion[this.combinacion.length - 1] == \" \") {\n            aux = this.combinacion.slice(0, -2);\n          }\n                 let combinaciones: Array<any> = aux.split(\", \");\n          combinaciones = combinaciones.map((combinacion, index) => {\n            let auxLength = combinacion.length;\n            if (auxLength != 0) {\n              if (auxLength < this.maxDigits) {\n                let auxAdd = this.maxDigits - auxLength;\n                for (let i = 1; i <= auxAdd; i++) {\n                  combinacion = `0${combinacion}`;\n                }\n              }\n              return combinacion;\n            }\n          });\n          */\n\n          if (_this2.sorteoGanador == 'default') {\n            _this2.dismissLoader();\n\n            _this2.openError('Por favor, selecciona un sorteo');\n\n            return;\n          }\n\n          let combinaciones = [{\n            principal: _this2.combinacion,\n            serie: _this2.serie\n          }];\n          let data = yield _this2.consulta.recuperarBoletoGanador(_this2.sorteoGanador, combinaciones);\n\n          _this2.resultados.emit(data);\n\n          _this2.dismissLoader();\n        } catch (e) {\n          _this2.dismissLoader();\n\n          _this2.openError(e.message);\n\n          console.log(e);\n        }\n      })();\n    }\n\n    buscarBoletin() {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        if (_this3.sorteoBoletin == 'default') {\n          _this3.openError('Por favor, selecciona un sorteo');\n\n          return;\n        }\n\n        _this3.router.navigateByUrl(`/consultas/millonaria/boletin/${_this3.sorteoBoletin}`);\n      })();\n    }\n\n    openError(msg) {\n      this.errorMessage = msg;\n      this.isError = true;\n    }\n\n    closeError() {\n      this.isError = false;\n    }\n\n  }\n\n  ConsultaComponent.ɵfac = function ConsultaComponent_Factory(t) {\n    return new (t || ConsultaComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ConsultaService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n\n  ConsultaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ConsultaComponent,\n    selectors: [[\"millonaria-consulta\"]],\n    outputs: {\n      resultados: \"resultados\"\n    },\n    decls: 68,\n    vars: 8,\n    consts: [[1, \"container_consulta\"], [1, \"cuerpo_boletin\"], [1, \"explicacion\"], [1, \"content_explicacion\"], [1, \"icono\"], [1, \"separador\"], [1, \"consulta_boleto\"], [1, \"\"], [\"action\", \"\", 1, \"formulario\"], [1, \"input\"], [1, \"input_content\"], [\"for\", \"\"], [\"name\", \"combinaciones\", \"type\", \"text\", \"maxlength\", \"4\", 3, \"ngModel\", \"input\", \"ngModelChange\"], [\"name\", \"serie\", \"type\", \"text\", 3, \"ngModel\", \"input\", \"ngModelChange\"], [\"name\", \"sorteoGanador\", \"id\", \"sorteoGanador\", \"placeholder\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"default\", \"selected\", \"\", \"disabled\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"click\"], [1, \"consulta_boleto\", \"espacio\"], [\"name\", \"sorteoBoletin\", \"id\", \"sorteoBoletin\", \"placeholder\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"loader\", \"millonaria\", 3, \"message\", 4, \"ngIf\"], [3, \"msg\", \"closeError\", 4, \"ngIf\"], [3, \"value\"], [\"loader\", \"millonaria\", 3, \"message\"], [3, \"msg\", \"closeError\"]],\n    template: function ConsultaComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"h1\");\n        i0.ɵɵtext(3, \"Consultas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 2);\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵelementStart(6, \"p\", 4);\n        i0.ɵɵtext(7, \"1\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"p\");\n        i0.ɵɵtext(9, \"Ingresa la combinaci\\u00F3n principal y la serie de tu boleto.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 3);\n        i0.ɵɵelementStart(11, \"p\", 4);\n        i0.ɵɵtext(12, \"2\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"p\");\n        i0.ɵɵtext(14, \"Luego Elige la fecha del sorteo.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 3);\n        i0.ɵɵelementStart(16, \"p\", 4);\n        i0.ɵɵtext(17, \"!\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"p\");\n        i0.ɵɵtext(19, \" Los boletos a consultar deben corresponder a la misma fecha y puedes revisar de los ultimos 3 meses. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 5);\n        i0.ɵɵelement(21, \"hr\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 6);\n        i0.ɵɵelementStart(23, \"h3\", 7);\n        i0.ɵɵtext(24, \"Consulta por Boleto y Sorteo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"form\", 8);\n        i0.ɵɵelementStart(26, \"div\", 9);\n        i0.ɵɵelementStart(27, \"div\", 10);\n        i0.ɵɵelementStart(28, \"label\", 11);\n        i0.ɵɵtext(29, \"Ingresa numero de boleto:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"input\", 12);\n        i0.ɵɵlistener(\"input\", function ConsultaComponent_Template_input_input_30_listener() {\n          return ctx.validateCombinacion();\n        })(\"ngModelChange\", function ConsultaComponent_Template_input_ngModelChange_30_listener($event) {\n          return ctx.combinacion = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"p\");\n        i0.ɵɵtext(32, \" Ingresa los 4 d\\u00EDgitos de la combinaci\\u00F3n principal de tu boleto. Solo puedes consultar un boleto a la vez. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"div\", 9);\n        i0.ɵɵelementStart(34, \"div\", 10);\n        i0.ɵɵelementStart(35, \"label\", 11);\n        i0.ɵɵtext(36, \"Ingresa la serie de tu boleto:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"input\", 13);\n        i0.ɵɵlistener(\"input\", function ConsultaComponent_Template_input_input_37_listener() {\n          return ctx.validateSerie();\n        })(\"ngModelChange\", function ConsultaComponent_Template_input_ngModelChange_37_listener($event) {\n          return ctx.serie = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"p\");\n        i0.ɵɵtext(39, \" Ingresa todos los d\\u00EDgitos de la serie de tu boleto. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"div\", 9);\n        i0.ɵɵelementStart(41, \"div\", 10);\n        i0.ɵɵelementStart(42, \"label\", 11);\n        i0.ɵɵtext(43, \"Selecciona el numero del sorteo:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"select\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function ConsultaComponent_Template_select_ngModelChange_44_listener($event) {\n          return ctx.sorteoGanador = $event;\n        });\n        i0.ɵɵelementStart(45, \"option\", 15);\n        i0.ɵɵtext(46, \" Seleccione un sorteo \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(47, ConsultaComponent_option_47_Template, 2, 3, \"option\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function ConsultaComponent_Template_button_click_48_listener() {\n          return ctx.buscarBoletoGanador();\n        });\n        i0.ɵɵtext(49, \"VER RESULTADOS\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"div\", 5);\n        i0.ɵɵelement(51, \"hr\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(52, \"div\", 18);\n        i0.ɵɵelementStart(53, \"h3\", 7);\n        i0.ɵɵtext(54, \"Consulta por Boletin de Resultados\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"form\", 8);\n        i0.ɵɵelementStart(56, \"div\", 9);\n        i0.ɵɵelementStart(57, \"div\", 10);\n        i0.ɵɵelementStart(58, \"label\", 11);\n        i0.ɵɵtext(59, \"Selecciona el numero del sorteo:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(60, \"select\", 19);\n        i0.ɵɵlistener(\"ngModelChange\", function ConsultaComponent_Template_select_ngModelChange_60_listener($event) {\n          return ctx.sorteoBoletin = $event;\n        });\n        i0.ɵɵelementStart(61, \"option\", 15);\n        i0.ɵɵtext(62, \" Seleccione un sorteo \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(63, ConsultaComponent_option_63_Template, 2, 3, \"option\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(64, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function ConsultaComponent_Template_button_click_64_listener() {\n          return ctx.buscarBoletin();\n        });\n        i0.ɵɵtext(65, \"VER RESULTADOS\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(66, ConsultaComponent_app_loader_66_Template, 1, 1, \"app-loader\", 20);\n        i0.ɵɵtemplate(67, ConsultaComponent_app_error_67_Template, 1, 1, \"app-error\", 21);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(30);\n        i0.ɵɵproperty(\"ngModel\", ctx.combinacion);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.serie);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.sorteoGanador);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.sorteosJugados);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngModel\", ctx.sorteoBoletin);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.sorteosJugados);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isError);\n      }\n    },\n    directives: [i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i3.DefaultValueAccessor, i3.MaxLengthValidator, i3.NgControlStatus, i3.NgModel, i3.SelectControlValueAccessor, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i4.NgForOf, i4.NgIf, i5.LoaderComponent, i6.ErrorComponent],\n    styles: [\".container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .input_content[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .input_content[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%], .container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   .input_content[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding:13px 0 13px 6px;color:#977474;background-color:#fff;border:none;border-left:4px solid #b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .explicacion[_ngcontent-%COMP%]   .content_explicacion[_ngcontent-%COMP%]   .icono[_ngcontent-%COMP%]{color:#b51f20;border:2px solid #b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#b51f20;border:1px solid #b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#b51f20;border:1px solid #b51f20}.container_consulta[_ngcontent-%COMP%]   .cuerpo_boletin[_ngcontent-%COMP%]   .consulta_boleto[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#b51f20}.container_consulta[_ngcontent-%COMP%]   .pie_boletin[_ngcontent-%COMP%]{background-color:#b51f20}\"]\n  });\n  return ConsultaComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}
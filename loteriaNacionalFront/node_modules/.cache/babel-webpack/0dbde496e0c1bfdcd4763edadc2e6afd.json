{"ast":null,"code":"import _asyncToGenerator from \"/home/angeloacr/Proyectos/loteriaNacional/app/loteriaNacionalFront/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/pagos.service\";\nimport * as i3 from \"../../services/ventas.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../components/descripcion-de-venta/descripcion-de-venta.component\";\nimport * as i6 from \"../../../shared/components/loader/loader.component\";\nimport * as i7 from \"../../../shared/components/error/error.component\";\n\nfunction DetalleDeVentaComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"app-descripcion-de-venta\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"compra\", ctx_r0.compra)(\"codigosPromocionales\", ctx_r0.codigosPromocionales)(\"user\", ctx_r0.user)(\"ticketId\", ctx_r0.ticketId);\n  }\n}\n\nfunction DetalleDeVentaComponent_app_loader_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-loader\", 4);\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"message\", ctx_r1.loadingMessage);\n  }\n}\n\nfunction DetalleDeVentaComponent_app_error_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-error\", 5);\n    i0.ɵɵlistener(\"closeError\", function DetalleDeVentaComponent_app_error_2_Template_app_error_closeError_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.closeError();\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"msg\", ctx_r2.errorMessage);\n  }\n}\n\nexport let DetalleDeVentaComponent = /*#__PURE__*/(() => {\n  class DetalleDeVentaComponent {\n    constructor(actRoute, pagos, ventas) {\n      this.actRoute = actRoute;\n      this.pagos = pagos;\n      this.ventas = ventas;\n      this.codigosPromocionales = [];\n      this.compraReady = false;\n      this.isError = false;\n      this.actRoute.params.subscribe(params => {\n        let aux = params['id'];\n        this.accountId = aux.split('-')[0];\n        this.ticketId = aux.split('-')[1];\n      });\n    }\n\n    ngOnInit() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        try {\n          _this.loadingMessage = 'Consultando el detalle de tu compra';\n          _this.isLoading = true;\n          _this.compra = yield _this.pagos.getCompra(_this.ticketId, _this.accountId);\n          _this.codigosPromocionales = yield _this.pagos.getCodigosPromocionales(_this.ticketId);\n          _this.user = _this.compra.user ? _this.compra.user : _this.ventas.getAuthData().user;\n          _this.ganador = yield _this.pagos.getGanador(_this.ticketId);\n\n          if (_this.ganador.status) {\n            let resultadosGanadores = _this.ganador.values;\n\n            _this.compra.loteria.forEach(element => {\n              element['detalleGanador'] = [];\n            });\n\n            _this.compra.lotto.forEach(element => {\n              element['detalleGanador'] = [];\n            });\n\n            _this.compra.pozo.forEach(element => {\n              element['detalleGanador'] = [];\n            });\n\n            _this.compra.millonaria.forEach(element => {\n              element['detalleGanador'] = [];\n            });\n\n            for (let i = 0; i < resultadosGanadores.length; i++) {\n              const ganador = resultadosGanadores[i];\n              let ganadorIndex;\n\n              switch (ganador.tipoLoteria) {\n                case 1:\n                  ganadorIndex = _this.compra.loteria.findIndex(x => x.combinacion1 == ganador.combinacion1 && x.sorteo == ganador.numeroSorteo);\n\n                  if (ganadorIndex != -1) {\n                    _this.compra.loteria[ganadorIndex]['hasGanador'] = true;\n\n                    _this.compra.loteria[ganadorIndex]['detalleGanador'].push(ganador);\n                  }\n\n                  break;\n\n                case 2:\n                  ganadorIndex = _this.compra.lotto.findIndex(x => x.combinacion1 == ganador.combinacion1 && x.sorteo == ganador.numeroSorteo);\n\n                  if (ganadorIndex != -1) {\n                    _this.compra.lotto[ganadorIndex]['hasGanador'] = true;\n\n                    _this.compra.lotto[ganadorIndex]['detalleGanador'].push(ganador);\n                  }\n\n                  break;\n\n                case 5:\n                  ganadorIndex = _this.compra.pozo.findIndex(x => x.combinacion1 == ganador.combinacion1 && x.sorteo == ganador.numeroSorteo);\n\n                  if (ganadorIndex != -1) {\n                    _this.compra.pozo[ganadorIndex]['hasGanador'] = true;\n\n                    _this.compra.pozo[ganadorIndex]['detalleGanador'].push(ganador);\n                  }\n\n                  break;\n\n                case 14:\n                  ganadorIndex = _this.compra.millonaria.findIndex(x => x.combinacion1 == ganador.combinacion1 && x.sorteo == ganador.numeroSorteo);\n\n                  if (ganadorIndex != -1) {\n                    _this.compra.millonaria[ganadorIndex]['hasGanador'] = true;\n\n                    _this.compra.millonaria[ganadorIndex]['detalleGanador'].push(ganador);\n                  }\n\n                  break;\n              }\n            }\n          }\n\n          _this.compraReady = true;\n          _this.isLoading = false;\n        } catch (e) {\n          console.log(e.message);\n          _this.isLoading = false;\n\n          _this.openError(e.message);\n        }\n      })();\n    }\n\n    openError(msg) {\n      this.errorMessage = msg;\n      this.isError = true;\n    }\n\n    closeError() {\n      this.isError = false;\n    }\n\n  }\n\n  DetalleDeVentaComponent.ɵfac = function DetalleDeVentaComponent_Factory(t) {\n    return new (t || DetalleDeVentaComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.PagosService), i0.ɵɵdirectiveInject(i3.VentasService));\n  };\n\n  DetalleDeVentaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DetalleDeVentaComponent,\n    selectors: [[\"app-detalle-de-venta\"]],\n    decls: 3,\n    vars: 3,\n    consts: [[4, \"ngIf\"], [\"loader\", \"loteria\", 3, \"message\", 4, \"ngIf\"], [3, \"msg\", \"closeError\", 4, \"ngIf\"], [3, \"compra\", \"codigosPromocionales\", \"user\", \"ticketId\"], [\"loader\", \"loteria\", 3, \"message\"], [3, \"msg\", \"closeError\"]],\n    template: function DetalleDeVentaComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, DetalleDeVentaComponent_ng_container_0_Template, 2, 4, \"ng-container\", 0);\n        i0.ɵɵtemplate(1, DetalleDeVentaComponent_app_loader_1_Template, 1, 1, \"app-loader\", 1);\n        i0.ɵɵtemplate(2, DetalleDeVentaComponent_app_error_2_Template, 1, 1, \"app-error\", 2);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.compraReady);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isError);\n      }\n    },\n    directives: [i4.NgIf, i5.DescripcionDeVentaComponent, i6.LoaderComponent, i7.ErrorComponent],\n    styles: [\".titleBox[_ngcontent-%COMP%]{width:80%;display:flex;justify-content:space-between;align-items:center;margin:20px 0;font-weight:600}.titleBox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:\\\"Monstserrat Regular\\\";font-size:14px}.titleBox[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-family:\\\"Monstserrat Regular\\\"}.containerInfoBox[_ngcontent-%COMP%]   .titleLoteryBo[_ngcontent-%COMP%]   x[_ngcontent-%COMP%]{display:flex;background-color:#f2f2f2}.containerInfoBox[_ngcontent-%COMP%]   .titleLoteryBo[_ngcontent-%COMP%]   x[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-left:20px;color:#000;font-family:\\\"Monstserrat SemiBold\\\";font-size:16px}.containerInfoBox[_ngcontent-%COMP%]   .fondoBox[_ngcontent-%COMP%]{justify-content:space-between;background-color:#7c91a8;padding-left:20px;padding-right:10px}.containerInfoBox[_ngcontent-%COMP%]   .dateClientBox[_ngcontent-%COMP%]{width:100%}.containerInfoBox[_ngcontent-%COMP%]   .dateClientBox[_ngcontent-%COMP%]   .infoClientBox[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.containerInfoBox[_ngcontent-%COMP%]   .dateClientBox[_ngcontent-%COMP%]   .infoClientBox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:nth-child(1){margin-left:20px}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]{display:grid;grid-template-columns:30% 1fr;grid-column-gap:3rem;column-gap:3rem}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]   .infoSorteoBox[_ngcontent-%COMP%]{margin-left:20px}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]   .infoSorteoBox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;font-size:15px}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]   .infoTicketBox[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);font-family:\\\"Monstserrat Regular\\\";font-size:15px}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]   .infoTicketBox[_ngcontent-%COMP%]   .dateTicketBox[_ngcontent-%COMP%]{font-weight:600;font-size:15px}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]   .infoTicketBox[_ngcontent-%COMP%]   .numberBox[_ngcontent-%COMP%]{text-align:center}.containerInfoBox[_ngcontent-%COMP%]   .dateLoteryBox[_ngcontent-%COMP%]   .infoTicketBox[_ngcontent-%COMP%]   .montoBox[_ngcontent-%COMP%]{text-align:right;font-weight:600}.totalBox[_ngcontent-%COMP%]{width:100%;margin:auto auto 70px;display:flex;justify-content:flex-end}.totalBox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:\\\"Monstserrat Regular\\\";color:#000}.totalBox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:red}.mensajeButtonBox[_ngcontent-%COMP%]{margin:auto auto 20px;padding:16px;cursor:pointer;display:flex;justify-content:center;align-items:center;border:1px solid #c3c3c3}.mensajeButtonBox[_ngcontent-%COMP%]:hover{background-color:green}.mensajeButtonBox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:\\\"Monstserrat SemiBold\\\";font-size:23px;color:green}.mensajeButtonBox[_ngcontent-%COMP%]:hover   p[_ngcontent-%COMP%]{color:#fff}\"]\n  });\n  return DetalleDeVentaComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}